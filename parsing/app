#!/usr/bin/env python3
from __future__ import annotations

import argparse
from pathlib import Path

from pipeline.pipeline import build_pipeline
from pipeline.context import PipelineContext


def main() -> int:
    parser = argparse.ArgumentParser(
        prog="app",
        description="HH CSV -> x_data.npy + y_data.npy",
    )
    parser.add_argument("csv_path", type=str, help="Path to hh.csv")
    args = parser.parse_args()

    csv_path = Path(args.csv_path).expanduser().resolve()
    if not csv_path.exists():
        raise FileNotFoundError(f"CSV not found: {csv_path}")

    ctx = PipelineContext(csv_path=csv_path)
    pipeline = build_pipeline()
    pipeline.handle(ctx)

    return 0


if __name__ == "__main__":
    raise SystemExit(main())
